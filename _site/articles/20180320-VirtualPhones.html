<!DOCTYPE html>
<html lang="en" class="no-js">

<!--  Setting Parameter -->


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />

    <title>INTACT Virtual Phones Tutorial</title>
    <meta name="description" content="
QiTASC is an Austrian company that excels in automated end-to-end testing. Find out how we can help your business achieve a new level of testing with our INTACT® software.
">

	<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/favicons/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/favicons/manifest.json">
	<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#f7941e">
	<link rel="shortcut icon" href="/favicons/favicon.ico">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
	<meta name="msapplication-config" content="/favicons/browserconfig.xml">
	<meta name="theme-color" content="#f7941e">


  <link rel="stylesheet" type="text/css" href="/css/navigation.css">
  <link rel="stylesheet" type="text/css" href="/css/newsroomSlider.css">
  <link rel="stylesheet" type="text/css" href="/css/mainTools.css">
  <link rel="stylesheet" type="text/css" href="/css/hero.css">
  <link rel="stylesheet" type="text/css" href="/css/usecases.css">
  <link rel="stylesheet" type="text/css" href="/css/wordcloud.css">
  <link rel="stylesheet" type="text/css" href="/css/Footer-Dark.css">
  <link rel="stylesheet" type="text/css" href="/css/qualities.css">
  <link rel="stylesheet" type="text/css" href="/css/references.css">
	<!-- include webfonts -->
	<link rel="stylesheet" type="text/css" href="/css/webfonts.css">

   <!-- Latest compiled and minified CSS -->
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

</head>


  <header>

    <!--  ########################################################################### -->
<!--  ########################################################################### -->
<!--  ####                                                                   #### -->
<!--  ####                                                                   #### -->
<!--  ####                    Top Header Container                           #### -->
<!--  ####                                                                   #### -->
<!--  ####                                                                   #### -->
<!--  ########################################################################### -->
<!--  ########################################################################### -->


<div class="container-fluid stickyNavContainer shadowBottom">
    <div class="container stickyNavSubContainer">
        <div class="row form-inline">
          <div class="LogoContainer">
              <div class="col"><a href="#"><img class="Logo" src="/assets/images/standalone.png"></a></div>
          </div>

                    <div class="col col-xs-4 buttonPadding">
                        <button id="toggleProducts" class="navigationButton">Products
                          <i class="arrow down"></i></button>
                    </div>
                    <div class="col col-xs-4 buttonPadding">
                        <button id="toggleServices" class="navigationButton">Services

                          <!-- <i class="arrow down"></i> -->

                        </button>
                    </div>
                    <div class="col col-xs-4 buttonPadding">
                        <button id="toggleSupport" class="navigationButton">Support
                          <i class="arrow down"></i></button>
                    </div>


        </div>
    </div>
</div>


<!--  ########################################################################### -->
<!--  ########################################################################### -->
<!--  ########################################################################### -->
<!--  ########################################################################### -->
<!--  ########################################################################### -->


<div class="wrapper">
  <div id="secondaryNavContainer">
      <div class="displayedContentProducts">
        <div class="row">

<!--
// ##################################################################################
//            MobileViewNavigation, visible below 768 px                     #######
// ##################################################################################
 -->


<div class="col leftPadding">

              <p><div class="navigationSecondaryHeader">Specify</div></p>

              <div class="row rowProductIcons">
                <div class="col">
                  <div class="floatproduct disQover">
                      <img class="productIcon" src="/assets/images/productIcons/disQover_256x256.png">
                      <div class="productHeader">disQover</div>
                  </div>
                  <div class="productShorterDescription">test case generation</div>
                  <div class="productDescription">Model-based test case generation</div>
                </div>
              </div>


              <div class="row rowProductIcons">
                <div class="col">
                  <div class="floatproduct cheQ">
                      <img class="productIcon" src="/assets/images/productIcons/cheQ_256x256.png">
                      <div class="productHeader">cheQ</div>
                  </div>
                  <div class="productShorterDescription">Trace Verification</div>
<div class="productDescription">Automated trace verification</div>
                </div>
              </div>
            <p><div class="navigationSecondaryHeader">Execute</div></p>
            <div class="row rowProductIcons">
              <div class="col">
                <div class="floatproduct intaQt">
                    <img class="productIcon" src="/assets/images/productIcons/intaQt_256x256.png">
                    <div class="productHeader">intaQt</div>
                </div>
                <div class="productShorterDescription">Managing Projects</div>
<div class="productDescription">Manage test automation projects</div>
              </div>
            </div>

            <div class="row rowProductIcons">
              <div class="col">
                <div class="floatproduct intaQt">
                    <img class="productIcon" src="/assets/images/productIcons/Studio_256x256.png">
                    <div class="productHeader">Studio</div>
                </div>
                <div class="productShorterDescription">IDE for testing</div>
<div class="productDescription">An IDE made for testing</div>
              </div>
            </div>

            <div class="row rowProductIcons">
              <div class="col">
                <div class="floatproduct intaQt">
                    <img class="productIcon" src="/assets/images/productIcons/Client_256x256.png">
                    <div class="productHeader">Client</div>
                </div>
                <div class="productShorterDescription">CLI Support</div>
<div class="productDescription">CLI & continuous integration support</div>
              </div>
            </div>

            <div class="row rowProductIcons">
              <div class="col">
                <div class="floatproduct sQedule">
                    <img class="productIcon" src="/assets/images/productIcons/sQedule_256x256.png">
                    <div class="productHeader">sQedule</div>
                </div>
                <div class="productShorterDescription">Test Management</div>
<div class="productDescription">Intelligent device management</div>
              </div>
            </div>
            <p><div class="navigationSecondaryHeader">Analyze</div></p>

            <div class="row rowProductIcons">
              <div class="col">
                <div class="floatproduct conQlude">
                    <img class="productIcon" src="/assets/images/productIcons/conQlude_256x256.png">
                    <div class="productHeader">conQlude</div>
                </div>
                <div class="productShorterDescription">Reporting</div>
<div class="productDescription">Integrated reporting and issue tracking</div>
              </div>
            </div>
            <div class="row rowProductIcons">
              <div class="col">
                <div class="floatproduct analytiQs">
                    <img class="productIcon" src="/assets/images/productIcons/analytiQs_256x256.png">
                    <div class="productHeader">analytiQs</div>
                </div>
                <div class="productShorterDescription">Description</div>
<div class="productDescription">Analyising Test Cases</div>
              </div>
            </div>
</div>


<!--
    // ##################################################################################
    //            Desktop View of the Navigation over 768px                       #######
    // ##################################################################################
-->

<div class="col DesktopNavColFirst">


          <p><div class="navigationSecondaryHeader">Specify</div></p>
          <div class="row rowProductIcons">
            <div class="col">
              <div class="floatproduct disQover">
                  <img class="productIcon" src="/assets/images/productIcons/disQover_256x256.png">
                  <div class="productHeader">disQover</div>
              </div>
              <div class="productShorterDescription">test case generation</div>
<div class="productDescription">Model-based test case generation</div>
            </div>
          </div>


          <div class="row rowProductIcons">
            <div class="col">
              <div class="floatproduct cheQ">
                  <img class="productIcon" src="/assets/images/productIcons/cheQ_256x256.png">
                  <div class="productHeader">cheQ</div>
              </div>
              <div class="productShorterDescription">Trace Verification</div>
<div class="productDescription">Automated trace verification</div>
            </div>
          </div>
</div>


<div class="col DesktopNavCol">

        <p><div class="navigationSecondaryHeader">Execute</div></p>
        <div class="row rowProductIcons">
          <div class="col">
            <div class="floatproduct intaQt">
                <img class="productIcon" src="/assets/images/productIcons/intaQt_256x256.png">
                <div class="productHeader">intaQt</div>
            </div>
            <div class="productShorterDescription">Managing Projects</div>
<div class="productDescription">Manage test automation projects</div>
          </div>
        </div>

        <div class="row rowProductIcons">
          <div class="col">
            <div class="floatproduct intaQt">
                <img class="productIcon" src="/assets/images/productIcons/Studio_256x256.png">
                <div class="productHeader">Studio</div>
            </div>
            <div class="productShorterDescription">IDE for testing</div>
<div class="productDescription">An IDE made for testing</div>
          </div>
        </div>

        <div class="row rowProductIcons">
          <div class="col">
            <div class="floatproduct intaQt">
                <img class="productIcon" src="/assets/images/productIcons/Client_256x256.png">
                <div class="productHeader">Client</div>
            </div>
            <div class="productShorterDescription">CLI Support</div>
<div class="productDescription">CLI & continuous integration support</div>
          </div>
        </div>

        <div class="row rowProductIcons">
          <div class="col">
            <div class="floatproduct sQedule">
                <img class="productIcon" src="/assets/images/productIcons/sQedule_256x256.png">
                <div class="productHeader">sQedule</div>
            </div>
            <div class="productShorterDescription">Test Management</div>
<div class="productDescription">Intelligent device management</div>
          </div>
        </div>

</div>


<div class="col DesktopNavColLast">

        <p><div class="navigationSecondaryHeader">Analyze</div></p>

        <div class="row rowProductIcons">
          <div class="col">
            <div class="floatproduct conQlude">
                <img class="productIcon" src="/assets/images/productIcons/conQlude_256x256.png">
                <div class="productHeader">conQlude</div>
            </div>
            <div class="productShorterDescription">Reporting</div>
<div class="productDescription">Integrated reporting and issue tracking</div>
          </div>
        </div>
        <div class="row rowProductIcons">
          <div class="col">
            <div class="floatproduct analytiQs">
                <img class="productIcon" src="/assets/images/productIcons/analytiQs_256x256.png">
                <div class="productHeader">analytiQs</div>
            </div>
            <div class="productShorterDescription">Description</div>
<div class="productDescription">Analyising Test Cases</div>
          </div>
        </div>

</div>



<!--
    // ##################################################################################
    //            Grey Side Menu on Screen over 410px                             #######
    // ##################################################################################
-->
  <div class="col greyColumn">

        <!--  Close Button  -->
        <div class="row leftSideNavMenucloseButton">
            <img id="closeButtonID" class="closeButton" src="/assets/images/navBar/x_1.png">
        </div>

        <div class="row leftSideNavMenuItem">Newsroom</div>
        <div class="row leftSideNavMenuItem">About</div>
        <div class="row leftSideNavMenuItem">Support</div>
        <div class="row leftSideNavMenuItem">Documentation</div>
        <div class="row leftSideNavMenuItem">Contact</div>
        <div class="row leftSideNavMenuItem">Impressum</div>

</div>


</div>

      </div>
      <div class="displayedContentSupport">
        Support
      </div>
  </div>
  </div>
</div>


<div class="transparentOverlayOfContent" id="transparentOverlay"></div>








<!--  Services Sub Navigation -->

  </header>

  <body>







      <main>

        
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/article.js"></script>















<div class="qitasc-light p-y-4 qitasc-article-header">
    <div class="row">
          <h1><span class="orange">IN</span>TACT<sup>®</sup> Virtual Phones Tutorial</h1>
          <div id="article-subheader">
              <h4>With the flick of a configuration switch, INTACT allows you to change between using virtual phones and real phones in your testing environment. This tutorial walks you through setting up a project and creating your own custom steps to automate virtual phones.<h4>

              
              
              

              


          </div>
    </div>
  </br>
</div>







</br>










<div id="floating-container">
          
          
          
                <div class="floating-box">
                  <a href="#Introduction"><center>Virtual Phones Introduction</center></a></br>
                </div>
          
          
                <div class="floating-box">
                  <a href="#CreateProject"><center>Create Project</center></a></br>
                </div>
          
          
                <div class="floating-box">
                  <a href="#CreateTestCase"><center>Create Test Case</center></a></br>
                </div>
          
          
                <div class="floating-box">
                  <a href="#PhoneAllocation"><center>Custom Phone Allocation</center></a></br>
                </div>
          
          
                <div class="floating-box">
                  <a href="#MockCallStep"><center>Mock Call Step</center></a></br>
                </div>
          
          
                <div class="floating-box">
                  <a href="#UsingListParameters"><center>List Parameters</center></a></br>
                </div>
          
</div>





<div class="floating-container-mobile">
  <input id="collapsible-01" class="toggle-floating-mobile" type="checkbox">
  <label for="collapsible-01" class="lbl-toggle-floating-mobile">Table of Contents</label>
      <div class="collapsible-content-floating-mobile">
        <div class="floating-mobile-spacer"></div>
        
        
        
        <a class="floating-link-mobile" id="toggle-floating-input-1" href="#Introduction"><center>Virtual Phones Introduction</center></a></br>
        
        
        <a class="floating-link-mobile" id="toggle-floating-input-2" href="#CreateProject"><center>Create Project</center></a></br>
        
        
        <a class="floating-link-mobile" id="toggle-floating-input-3" href="#CreateTestCase"><center>Create Test Case</center></a></br>
        
        
        <a class="floating-link-mobile" id="toggle-floating-input-4" href="#PhoneAllocation"><center>Custom Phone Allocation</center></a></br>
        
        
        <a class="floating-link-mobile" id="toggle-floating-input-5" href="#MockCallStep"><center>Mock Call Step</center></a></br>
        
        
        <a class="floating-link-mobile" id="toggle-floating-input-6" href="#UsingListParameters"><center>List Parameters</center></a></br>
        
      </div>

</div>




<div class="qitasc-white qitasc-article-content">
  
<h1 id="using-custom-stepdefs-and-virtual-phones-">Using Custom Stepdefs and Virtual Phones <a name="Introduction"></a></h1>

<p>This tutorial demonstrates how to replace existing <strong>built-in telephony steps</strong> with <strong>custom step definitions</strong>. This is useful if you want to run Feature Files in a simulation environment without using real phones.</p>

<p>In this tutorial we are going to set up a simple telephony scenario using two phones, <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code>. <code class="highlighter-rouge">A</code> calls <code class="highlighter-rouge">B</code> and after a given call time, <code class="highlighter-rouge">B</code> ends the call.</p>

<p>Additionally, we will show how to use five types of <strong>stepdef parameters</strong>: <code class="highlighter-rouge">{}</code>, <code class="highlighter-rouge">{ident}</code>, <code class="highlighter-rouge">{phoneTags}</code>, <code class="highlighter-rouge">{phoneTag}</code>, and <code class="highlighter-rouge">{list}</code>.</p>

<p>For reference material, please refer to the Intact Manual’s <a href="https://docs.qitasc.com/intactsteps/customcompoundsteps">Custom Compound Steps</a> section.</p>

<h2 id="why-use-custom-stepdefs">Why Use Custom Stepdefs?</h2>

<p>Why would you like to replace existing stepdefs with your own definitions? There are two types of stepdefs in INTACT:</p>

<ul>
  <li><strong>Internal stepdefs</strong> (or <strong>built-in stepdefs</strong>) are implemented as part of the INTACT software. They can be used throughout your <code class="highlighter-rouge">.feature</code> files as is.</li>
  <li><strong>Custom stepdefs</strong> are implemented by the INTACT user employing the <code class="highlighter-rouge">webtest</code> and/or <code class="highlighter-rouge">soaptest</code> language. These stepdefs make use of INTACT’s Soaptest and Webtest built-in helper functions to provide custom functionality that is not covered by the internal stepdefs.</li>
</ul>

<p>If you want to develop your <code class="highlighter-rouge">.feature</code> files using a <strong>simulation environment</strong>, the built-in telephony steps can no longer be used, because they trigger real phones. <strong>Deactivating</strong> the built-in telephony steps allows the provision of your own custom telephony steps implementation. These custom steps can trigger your simulation environment instead of using real phones.</p>

<p>Using this method, you can develop your <code class="highlighter-rouge">.feature</code> files using a simulation environment and switch to the real phones when appropriate. By just flicking a configuration switch you change from one environment to another.</p>

<h1 id="create-project-">Create Project <a name="CreateProject"></a></h1>

<p>To execute the test cases from this tutorial, you first need to run the following products:</p>

<ul>
  <li>INTACT Server</li>
  <li>INTACT Studio</li>
</ul>

<p>The easiest way to do this is to open a Command Line/Terminal session and navigate to the QiTASC directory.</p>

<p>The enter the following:</p>

<p><strong>Windows Users</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qitasc start intact-server
qitasc start intact-studio
</code></pre></div></div>

<p><strong>Linux and Mac OSX Users</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./qitasc start intact-server
./qitasc start intact-studio
</code></pre></div></div>

<h2 id="run-intact-studio">Run INTACT Studio</h2>
<p>After launching the products, INTACT Studio will start. First, select <code class="highlighter-rouge">Create New Project</code>. Alternately, you can select <code class="highlighter-rouge">New</code> -&gt; <code class="highlighter-rouge">Project...</code> from the File menu.
<img src="/img/articles/apptest/02-StartIntact.png" alt="alt text" /></p>

<p>The following view will appear. Select <code class="highlighter-rouge">INTACT</code> and click the <code class="highlighter-rouge">Next</code> button.
<img src="/img/articles/apptest/02b-NewProject.png" alt="alt text" /></p>

<p>Assign your project the name <code class="highlighter-rouge">VirtualPhones</code>.</p>

<h2 id="create-the-directories">Create the Directories</h2>
<p>Create two directories: one to store your <strong>stepdefs</strong> and one to store your <strong>feature files</strong>. First, right-click on the project name <code class="highlighter-rouge">VirtualPhones</code> on the left-hand side of the window. Select <code class="highlighter-rouge">New</code>, then <code class="highlighter-rouge">Directory</code>. Name the directory <code class="highlighter-rouge">lang</code>. This is the folder where you store your <strong>stepdefs</strong>.</p>

<p><img src="/img/articles/virtualPhones/CreateDirectory.png" alt="alt text" /></p>

<p>Create a second directory and name it <code class="highlighter-rouge">features</code>. This is where you will store your <strong>feature files</strong>. Your project structure should now look like this:</p>

<p><img src="/img/articles/virtualPhones/projectStructure.png" alt="alt text" /></p>

<h1 id="create-the-test-case-">Create the Test Case <a name="CreateTestCase"></a></h1>

<p>Right-click on the <code class="highlighter-rouge">features</code> directory -&gt; <code class="highlighter-rouge">New</code> -&gt; <code class="highlighter-rouge">Feature</code>:</p>

<p><img src="/img/articles/virtualPhones/newFeature.png" alt="alt text" /></p>

<p>Name the Feature file <code class="highlighter-rouge">phoneConnection</code> and the <strong>Scenario</strong> <code class="highlighter-rouge">Phone connection</code>. INTACT Studio will append the <code class="highlighter-rouge">.feature</code> extension to the file.</p>

<h2 id="write-the-feature-file">Write the Feature File</h2>
<p>The scenario below is implemented as a standard scenario using two real phones. It can be run with INTACT’s internal stepdefs:</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Feature</span><span class="o">:</span><span class="x"> </span><span class="n">A</span><span class="x"> </span><span class="n">phone</span><span class="x"> </span><span class="n">can</span><span class="x"> </span><span class="n">dial</span><span class="x"> </span><span class="n">another</span><span class="x"> </span><span class="n">phone</span><span class="x"> </span><span class="n">and</span><span class="x"> </span><span class="n">connect</span><span class="x"> </span><span class="n">within</span><span class="x"> </span><span class="m">30</span><span class="x"> </span><span class="n">seconds</span><span class="x">

    </span><span class="n">Scenario</span><span class="o">:</span><span class="x"> </span><span class="n">Phone</span><span class="x"> </span><span class="n">connection</span><span class="x">
        </span><span class="n">Given</span><span class="x"> </span><span class="n">phones</span><span class="x"> </span><span class="n">as</span><span class="x"> </span><span class="n">A</span><span class="x"> </span><span class="n">and</span><span class="x"> </span><span class="n">B</span><span class="o">:</span><span class="x">
            </span><span class="o">*</span><span class="x"> </span><span class="n">of</span><span class="x"> </span><span class="k">type</span><span class="x"> </span><span class="n">Android</span><span class="x">
        </span><span class="n">And</span><span class="x"> </span><span class="n">A</span><span class="x"> </span><span class="n">starts</span><span class="x"> </span><span class="n">a</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="n">B</span><span class="x"> </span><span class="n">as</span><span class="x"> </span><span class="n">A2B</span><span class="o">:</span><span class="x">
            </span><span class="o">*</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">duration</span><span class="x"> </span><span class="n">is</span><span class="x"> </span><span class="m">1</span><span class="x"> </span><span class="n">seconds</span><span class="x">

        </span><span class="n">Then</span><span class="x"> </span><span class="n">within</span><span class="x"> </span><span class="m">30</span><span class="x"> </span><span class="n">seconds</span><span class="p">,</span><span class="x"> </span><span class="n">expect</span><span class="x"> </span><span class="n">the</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">A2B</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="n">connect</span><span class="x">
        </span><span class="n">Then</span><span class="x"> </span><span class="n">within</span><span class="x"> </span><span class="m">10</span><span class="x"> </span><span class="n">seconds</span><span class="p">,</span><span class="x"> </span><span class="n">expect</span><span class="x"> </span><span class="n">the</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">A2B</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="n">disconnect</span><span class="x">

</span></code></pre></div></div>

<h2 id="deactivate-the-internal-telephony-steps-and-try-to-run-the-scenario">Deactivate the Internal Telephony Steps and Try to Run the Scenario</h2>
<p>To deactivate the internal telephony built-in steps, add a <strong>configuration file</strong> to the project. Create a <strong>new empty file</strong> in the project root directory called <code class="highlighter-rouge">project.conf</code>. Your project structure should now look like this:</p>

<p><img src="/img/articles/virtualPhones/projectStructure2.png" alt="alt text" /></p>

<p>Paste the following into the <code class="highlighter-rouge">project.conf</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Glue</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">
    	</span><span class="err">path</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    	</span><span class="err">builtinTelephonySteps</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"deactivated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li><em>path</em> is a list of strings that denote all directories containing custom <code class="highlighter-rouge">soaptest</code>/<code class="highlighter-rouge">webtest</code> stepdef implementations. We will see how this is used shortly.</li>
  <li><em>builtinTelephonySteps</em> is a field that defines if the built-in telephony steps should be <strong>activated</strong> or <strong>deactivated</strong>. For this test case, the built-in telephony stepdefs are <code class="highlighter-rouge">"deactivated"</code>.</li>
</ul>

<p>Note that after applying this change, INTACT studio shows the telephony steps as <strong>unknown</strong> (they are automatically highlighted in red):</p>

<p><img src="/img/articles/virtualPhones/redText.png" alt="alt text" /></p>

<p>The steps marked in red are unknown by INTACT because they were <strong>removed</strong> by setting <code class="highlighter-rouge">builtinTelephonySteps</code> to <code class="highlighter-rouge">”deactivated”</code>. If you try to run this Feature file, the test will terminate with errors:</p>

<p><img src="/img/articles/virtualPhones/terminated.png" alt="alt text" /></p>

<h2 id="implement-custom-step-definitions">Implement Custom Step Definitions</h2>
<p>Next we will implement the missing steps that are marked in red. These step implementations are created using INTACT’s <code class="highlighter-rouge">soaptest</code> language. In order to tell INTACT where to find our new implementations, let’s edit our <code class="highlighter-rouge">Glue</code> configuration to tell it where our <code class="highlighter-rouge">*.soapatest</code> files are located.</p>

<p>Adapt the <code class="highlighter-rouge">project.conf</code> configuration file to reflect this new <code class="highlighter-rouge">.soaptest</code> location:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Glue</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">
    	</span><span class="err">path</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"lang"</span><span class="p">],</span><span class="w">
    	</span><span class="err">builtinTelephonySteps</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"deactivated"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p>This points to <code class="highlighter-rouge">lang</code> directory that we created earlier, which is where we will store the custom stepdef implementations.</p>

<p><span style="color:orange;"><strong>Note</strong></span>: When switching back to built-in telephony stepdefs (<code class="highlighter-rouge">builtinTelephonySteps = "activated"</code>), the Glue path entry <code class="highlighter-rouge">"lang"</code> must be removed. Otherwise INTACT will find duplicate, conflicting step definitions for the telephony steps. This will result in an error being reported.</p>

<h1 id="custom-phone-allocation-stepdef-">Custom Phone Allocation Stepdef <a name="PhoneAllocation"></a></h1>

<p>Now that we have configured our Glue path and deactivated the built-in telephony stepdefs, we will implement the <strong>custom step</strong> <code class="highlighter-rouge">Given phones as A and B:</code>.</p>

<p>Create a Soaptest file by right-clicking on the <code class="highlighter-rouge">lang</code> directory -&gt; <code class="highlighter-rouge">New</code> -&gt; <code class="highlighter-rouge">Soaptest</code>:</p>

<p><img src="/img/articles/virtualPhones/newSoaptest.png" alt="alt text" /></p>

<p>Name the Soaptest file <code class="highlighter-rouge">CustomTelephonyStepdefs</code>. INTACT Studio will append the <code class="highlighter-rouge">.soaptest</code> extension to the file. Replace the template text with the code below:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"a? ?phones? as {phoneTags}:"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">ids</span><span class="p">,</span><span class="x"> </span><span class="n">details</span><span class="x"> </span><span class="o">/</span><span class="x">

</span><span class="n">end</span><span class="x">
</span></code></pre></div></div>

<p>The stepdef keyword needs a <strong>regular expression</strong> (or <strong>regex</strong>) and a <strong>list of parameters</strong>.</p>

<h2 id="regular-expression">Regular Expression</h2>
<ul>
  <li>The regular expression defines the text that this stepdef uses.</li>
  <li>The question marks (<code class="highlighter-rouge">?</code>) indicate optional characters. In this case, all the phrases below would match the regular expression:
    <ul>
      <li><code class="highlighter-rouge">a phone as A</code></li>
      <li><code class="highlighter-rouge">phones as A and B</code></li>
      <li><code class="highlighter-rouge">phone as B</code></li>
    </ul>
  </li>
</ul>

<p>Note that the leading <code class="highlighter-rouge">Given</code>, <code class="highlighter-rouge">When</code>, and <code class="highlighter-rouge">Then</code> <strong>must not be part of the regular expression definition</strong>.</p>

<h2 id="parameters">Parameters</h2>
<p>This stepdef is special, because it ends with a colon (<code class="highlighter-rouge">:</code>). I.e.,it is a <strong>compound step</strong> that has <strong>detail clauses</strong>: lines starting with asterisks (<code class="highlighter-rouge">*</code>). Those details clauses are mapped to the last parameter <code class="highlighter-rouge">details</code> that does <em>NOT</em> correspond to a pair of curly braces in the regex.</p>

<p>The stepdef takes two parameters, called <code class="highlighter-rouge">ids</code> and <code class="highlighter-rouge">details</code>:</p>
<ul>
  <li>The position of the parameters in the text phrase are indicated by the curly braces (<code class="highlighter-rouge">{}</code>).</li>
  <li>The first parameter, <code class="highlighter-rouge">ids</code> holds the phone identifiers (characters such as <code class="highlighter-rouge">A</code> or <code class="highlighter-rouge">B</code>).</li>
  <li>The <code class="highlighter-rouge">phoneTags</code> keyword enclosed by the curly braces has a special meaning: it implicitly creates the given phones as <code class="highlighter-rouge">VirtualPhones</code>.</li>
</ul>

<h2 id="revise-the-stepdef-and-feature-file">Revise the Stepdef and Feature File</h2>
<p>To understand what how these parameters really work, let’s remove the <code class="highlighter-rouge">phoneTags</code> keyword form the braces and change our stepdef. Now it only holds the <strong>phone allocation</strong> step:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"a? ?phones? as {}:"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">ids</span><span class="p">,</span><span class="x"> </span><span class="n">details</span><span class="x"> </span><span class="o">/</span><span class="x">
	</span><span class="nb">println</span><span class="p">(</span><span class="s">"ids="</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">ids</span><span class="p">)</span><span class="x">
	</span><span class="nb">println</span><span class="p">(</span><span class="s">"details="</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">details</span><span class="p">)</span><span class="x">
</span><span class="n">end</span><span class="x">
</span></code></pre></div></div>

<p>Next, change the Feature file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Feature: A phone can dial another phone and connect within 30 seconds

  Scenario: Phone connection

    Given phones as A and B:
      * of type Android
</code></pre></div></div>

<p>This step does not do anything useful aside from taking the two parameters <code class="highlighter-rouge">ids</code> and <code class="highlighter-rouge">details</code> and printing them. If you right-click and
and try to run the Feature file, INTACT shows the error below:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="m">12</span><span class="o">:</span><span class="m">54</span><span class="o">:</span><span class="m">23.581</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">Step</span><span class="x"> </span><span class="n">started</span><span class="o">:</span><span class="x"> </span><span class="n">phones</span><span class="x"> </span><span class="n">as</span><span class="x"> </span><span class="n">A</span><span class="x"> </span><span class="n">and</span><span class="x"> </span><span class="n">B</span><span class="o">:</span><span class="x">
      </span><span class="o">*</span><span class="x"> </span><span class="n">of</span><span class="x"> </span><span class="k">type</span><span class="x"> </span><span class="n">Android</span><span class="x">
</span><span class="m">12</span><span class="o">:</span><span class="m">54</span><span class="o">:</span><span class="m">23.75</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">Step</span><span class="x"> </span><span class="n">ended</span><span class="x"> </span><span class="n">with</span><span class="x"> </span><span class="n">status</span><span class="o">:</span><span class="x"> </span><span class="n">failed</span><span class="x">
</span><span class="m">12</span><span class="o">:</span><span class="m">54</span><span class="o">:</span><span class="m">23.751</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="p">[</span><span class="n">Error</span><span class="o">:</span><span class="x"> </span><span class="n">unresolvable</span><span class="x"> </span><span class="n">property</span><span class="x"> </span><span class="n">or</span><span class="x"> </span><span class="n">identifier</span><span class="o">:</span><span class="x"> </span><span class="n">A</span><span class="p">]</span><span class="x">
</span><span class="p">[</span><span class="n">Near</span><span class="x"> </span><span class="o">:</span><span class="x"> </span><span class="p">{</span><span class="o">...</span><span class="x"> </span><span class="n">A</span><span class="x"> </span><span class="n">and</span><span class="x"> </span><span class="n">B</span><span class="x"> </span><span class="o">....</span><span class="p">}]</span><span class="x">
         	</span><span class="o">^</span><span class="x">
</span><span class="p">[</span><span class="n">Line</span><span class="o">:</span><span class="x"> </span><span class="m">1</span><span class="p">,</span><span class="x"> </span><span class="n">Column</span><span class="o">:</span><span class="x"> </span><span class="m">1</span><span class="p">]</span><span class="x">
</span></code></pre></div></div>

<p>The elements <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code> are not defined, i.e. they are not part of the scenario execution context.</p>

<p><span style="color:red;">Important!</span> An empty pair of curly braces <code class="highlighter-rouge">{}</code> in the stepdef <strong>regex</strong> tries to evaluate the corresponding expression against the scenario execution context before passing it on to the stepdef. Since <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code> are not there, the evaluation fails and the test will not run.</p>

<h2 id="fix-the-stepdef">Fix the Stepdef</h2>

<p>In order to fix the problem shown above, add the <code class="highlighter-rouge">phoneTags</code> keyword to the custom stepdef like this:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"a? ?phones? as {phoneTags}:"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">ids</span><span class="p">,</span><span class="x"> </span><span class="n">details</span><span class="x"> </span><span class="o">/</span><span class="x">
	</span><span class="nb">println</span><span class="p">(</span><span class="s">"ids="</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">ids</span><span class="p">)</span><span class="x">
	</span><span class="nb">println</span><span class="p">(</span><span class="s">"details="</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">details</span><span class="p">)</span><span class="x">
</span><span class="n">end</span><span class="x">

</span></code></pre></div></div>

<p>Run the test case again. At the bottom of the INTACT Studio window, you will see a list of executed steps, step details and their statuses. Click on the step <code class="highlighter-rouge">phones A and B:</code></p>

<p><img src="/img/articles/virtualPhones/testOutput.png" alt="alt text" /></p>

<p>The output from <code class="highlighter-rouge">ids</code> shows a list of two <strong>elements</strong>: <code class="highlighter-rouge">[A, B]</code>. By using the <code class="highlighter-rouge">phoneTags</code> keyword, <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code> are implicitly created as <strong>Virtual Phones</strong>. Now we can make use of these phones by adapting our stepdef.</p>

<h2 id="access-the-phone">Access the Phone</h2>
<p>Revise your stepdef to the following:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"a? ?phones? as {phoneTags}:"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">ids</span><span class="p">,</span><span class="x"> </span><span class="n">details</span><span class="x"> </span><span class="o">/</span><span class="x">
	</span><span class="nb">println</span><span class="p">(</span><span class="s">"ids= "</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">ids</span><span class="p">)</span><span class="x">
	</span><span class="nb">println</span><span class="p">(</span><span class="s">"details= "</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">details</span><span class="p">)</span><span class="x">
	</span><span class="k">for</span><span class="x"> </span><span class="n">phone</span><span class="x"> </span><span class="n">in</span><span class="x"> </span><span class="n">ids</span><span class="x">
    	</span><span class="n">p</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">getContextObject</span><span class="p">(</span><span class="n">phone</span><span class="p">)</span><span class="x">
    	</span><span class="nb">println</span><span class="p">(</span><span class="s">"p is "</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">p</span><span class="p">)</span><span class="x">
	</span><span class="n">end</span><span class="x">
</span><span class="n">end</span><span class="x">
</span></code></pre></div></div>

<p>After printing the parameters, a <code class="highlighter-rouge">for</code> loop runs through the elements in <code class="highlighter-rouge">ids</code> and prints them out. Accessing the scenario execution context is done using <code class="highlighter-rouge">getContextObject(phone)</code>. Here that <code class="highlighter-rouge">phone</code> is the <strong>loop variable</strong>. Also note that <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code> are part of the <strong>context</strong> since they were implicitly created when the stepdef started. This is why we can retrieve them and print them.</p>

<p>In the next section, we’ll create a virtual phone call. Meanwhile, you can read below for further details about <code class="highlighter-rouge">phoneTags</code>.</p>

<h3 id="additional-notes">Additional Notes</h3>

<p>The following examples provide some extra information about working with parameters.</p>

<h4 id="using-the-phonetags-keyword-single-phone">Using the phoneTags Keyword: Single Phone</h4>
<p>When using the <code class="highlighter-rouge">phoneTags</code> keyword for a stepdef parameter, the phones are <strong>always passed as a list</strong>. It is possible to use this for a single phone like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Given phones as A:
    * of type Android
</code></pre></div></div>

<p>In this case, the parameter is still passed as a list of <code class="highlighter-rouge">VirtualPhones</code>, but with a single element.</p>

<h4 id="using-the-phonetags-keyword-multiple-phones">Using the phoneTags Keyword: Multiple Phones</h4>

<p>When specifying multiple phones, the list can use commas <code class="highlighter-rouge">,</code> and the word <code class="highlighter-rouge">and</code> as separators. For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	Given phones as A and B, C and D:
          * of type Android
</code></pre></div></div>

<p>If you need a single VirtualPhone element, the <code class="highlighter-rouge">phoneTag</code> keyword may be used. The parameter is passed as a single phone (as opposed to a single element list). Details can be found in <a href="https://docs.qitasc.com/intact/chapters/">INTACT Manual</a>.</p>

<h1 id="implement-the-mock-call-step-">Implement the Mock Call Step <a name="MockCallStep"></a></h1>

<p>Now we’ll finish our test case by initiating the <strong>mock call</strong> with our virtual phones. But first, let’s revert the Feature file back to how we first wrote it:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Feature: phoneConnection

  Scenario: Phone connection
    Given phones as A and B:
      * of type Android
    And A starts a call to B as A2B:
      * call duration is 1 seconds

    Then within 30 seconds, expect the call A2B to connect
    Then within 10 seconds, expect the call A2B to disconnect
</code></pre></div></div>

<h2 id="create-the-second-stepdef">Create the Second Stepdef</h2>
<p>Copy and paste the following stepdef under the first stepdef in the <code class="highlighter-rouge">CustomTelephonyStepdefs.soaptest</code> file:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"{} starts a call to {} as {ident}"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">firstPhone</span><span class="p">,</span><span class="x"> </span><span class="n">secondPhone</span><span class="p">,</span><span class="x"> </span><span class="n">callName</span><span class="p">,</span><span class="x"> </span><span class="n">details</span><span class="x"> </span><span class="o">/</span><span class="x">
    </span><span class="nb">println</span><span class="p">(</span><span class="n">firstPhone</span><span class="p">)</span><span class="x">
    </span><span class="n">phoneCallMap</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">Telephony</span><span class="o">.</span><span class="n">parseCallDetails</span><span class="p">(</span><span class="n">firstPhone</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="x"> </span><span class="n">secondPhone</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="x"> </span><span class="n">details</span><span class="p">)</span><span class="x">

    </span><span class="nb">println</span><span class="p">(</span><span class="s">"CallDetails:"</span><span class="p">)</span><span class="x">
    </span><span class="k">for</span><span class="x"> </span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="x"> </span><span class="n">in</span><span class="x"> </span><span class="n">phoneCallMap</span><span class="x">
        </span><span class="nb">println</span><span class="p">(</span><span class="n">k</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="s">" : "</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">v</span><span class="p">)</span><span class="x">
    </span><span class="n">end</span><span class="x">

    </span><span class="n">firstPhone</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s">"customProperty"</span><span class="p">]</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="s">"hello"</span><span class="x">

    </span><span class="n">setContextObject</span><span class="p">(</span><span class="n">callName</span><span class="p">,</span><span class="x"> </span><span class="n">phoneCallMap</span><span class="p">)</span><span class="x">
</span><span class="n">end</span><span class="x">

</span></code></pre></div></div>

<p>Note that here both <code class="highlighter-rouge">{}</code> and <code class="highlighter-rouge">{ident}</code> are both used as parameter placeholders. The difference is important, and relates to how the variables are taken from the feature file:</p>
<ul>
  <li>In the first case, <code class="highlighter-rouge">{}</code>, the feature file passes the value of the expression that is defined. For example, if <code class="highlighter-rouge">A</code> is passed from the feature file, the variable <code class="highlighter-rouge">A</code> is passed. This is a <strong>VirtualPhone</strong>, which has an <strong>id</strong>, and a <strong>map of properties</strong>.</li>
  <li>With <code class="highlighter-rouge">{ident}</code>, whatever is written in the feature file is passed <strong>without evaluation</strong>. In this case, if <code class="highlighter-rouge">A</code> is passed, the string <code class="highlighter-rouge">”A”</code> will be passed through to the stepdef.</li>
</ul>

<p>This means that for the <code class="highlighter-rouge">{} starts call to {}...</code> stepdef, both “flavours” of placeholder are used. It is possible to use <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code> with <code class="highlighter-rouge">{}</code>, as prior to this step, both <code class="highlighter-rouge">A</code> and <code class="highlighter-rouge">B</code> have been set up in the environment. However, there is no variable called <code class="highlighter-rouge">A2B</code>, therefore this must be passed as a <strong>string</strong>.</p>

<h2 id="execute-the-test-and-review-the-results">Execute the Test And Review the Results</h2>
<p>Return to <code class="highlighter-rouge">phoneConnection.feature</code> and execute it by right-clicking and selecting <code class="highlighter-rouge">Run phoneConnection.feature...</code> The call details passed to the step are <strong>parsed</strong>. The result of this is simply a <strong>map</strong>. The map (printed out when the stepdef is executed) contains properties of the call. Click on the step <code class="highlighter-rouge">And A starts a call to B as A2B:</code> to see the maps’ contents. It will look something like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>13:17:49.401 [DEBUG]: Observing step 0.0: A starts a call to B as A2B:
13:17:49.404 [INFO]: Step started: A starts a call to B as A2B:
            * call duration is 1 seconds
13:17:49.405 [INFO]: com.tryge.autotest.server.utils.VirtualPhoneImpl@dbae786
13:17:49.422 [INFO]: CallDetails:
13:17:49.425 [INFO]: detectCallWithinSeconds : 30
13:17:49.426 [INFO]: callDuration : 1
13:17:49.429 [INFO]: callDurationUnit : seconds
13:17:49.434 [INFO]: hangupBy : CALLER
13:17:49.435 [INFO]: callerConnectsWithinSeconds : -1
13:17:49.437 [INFO]: calleeConnectsWithinSeconds : -1
13:17:49.438 [INFO]: callerId : A
13:17:49.438 [INFO]: callerDestination : CallDestination:Phone:A
13:17:49.44 [INFO]: calleeId : B
13:17:49.441 [INFO]: calleeDestination : CallDestination:Phone:B
13:17:49.442 [INFO]: dialFormat : int
13:17:49.443 [INFO]: detectFormat : any
13:17:49.443 [INFO]: ringDuration : 3
13:17:49.444 [INFO]: callForward : {}
13:17:49.444 [INFO]: speechChannelMonitor : null
13:17:49.445 [INFO]: notDetectCallWithinSeconds : -1
13:17:49.446 [INFO]: callRelayTo :
13:17:49.446 [INFO]: signaledNumber : null
13:17:49.449 [INFO]: callerAbandonsTheCall : false
13:17:49.45 [INFO]: calleeRejectsTheCall : false
13:17:49.451 [INFO]: calleeDoesNotAnswer : false
13:17:49.451 [INFO]: networkRejectsTheCallWithinSeconds : -1
13:17:49.452 [INFO]: Step ended with status: passed
13:17:49.452 [DEBUG]: Finished observing step.
</code></pre></div></div>

<p>In addition, a <strong>property</strong> is set here in the VirtualPhone. The <code class="highlighter-rouge">props</code> map acts as a data container that may be used to pass data around between steps.</p>

<h2 id="add-assertion-steps">Add Assertion Steps</h2>
<p>Finally, we will supply a mock implementation for the <code class="highlighter-rouge">assertion</code> steps. Copy and paste the following stepdef into your <code class="highlighter-rouge">CustomTelephonyStepdefs.soaptest</code> file. You should now have <strong>three</strong> distinct stepdefs:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"within {} seconds, expect the call {ident} to {ident}"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">seconds</span><span class="p">,</span><span class="x"> </span><span class="n">callId</span><span class="p">,</span><span class="x"> </span><span class="n">actionType</span><span class="x"> </span><span class="o">/</span><span class="x">
    </span><span class="n">simulatedActionSeconds</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="m">3</span><span class="x">
    </span><span class="n">delay</span><span class="p">(</span><span class="n">simulatedActionSeconds</span><span class="p">)</span><span class="x"> </span><span class="c">// simulate waiting for the phones to connect</span><span class="x">
    </span><span class="n">assert</span><span class="x"> </span><span class="n">seconds</span><span class="x"> </span><span class="o">&gt;</span><span class="x"> </span><span class="n">simulatedActionSeconds</span><span class="x"> </span><span class="c">// will fail if we waited too long</span><span class="x">
</span><span class="n">end</span><span class="x">

</span></code></pre></div></div>

<p>Here we simulate a call action happening after 4 seconds, after which we check that we did not have to wait too long (in this case the test will be failed due to the assertion).</p>

<p>With this timeout setting, the test passes. If we change the <strong>feature file</strong> to have a shorter timeout, for example using <code class="highlighter-rouge">Then within 2 seconds, expect the call A2B to connect</code>, then the test will fail. For example:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="m">13</span><span class="o">:</span><span class="m">37</span><span class="o">:</span><span class="m">32.94</span><span class="x"> </span><span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">Observing</span><span class="x"> </span><span class="n">step</span><span class="x"> </span><span class="m">0.1</span><span class="o">:</span><span class="x"> </span><span class="n">within</span><span class="x"> </span><span class="m">2</span><span class="x"> </span><span class="n">seconds</span><span class="p">,</span><span class="x"> </span><span class="n">expect</span><span class="x"> </span><span class="n">the</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">A2B</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="n">connect</span><span class="x">
</span><span class="m">13</span><span class="o">:</span><span class="m">37</span><span class="o">:</span><span class="m">32.94</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">Step</span><span class="x"> </span><span class="n">started</span><span class="o">:</span><span class="x"> </span><span class="n">within</span><span class="x"> </span><span class="m">2</span><span class="x"> </span><span class="n">seconds</span><span class="p">,</span><span class="x"> </span><span class="n">expect</span><span class="x"> </span><span class="n">the</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">A2B</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="n">connect</span><span class="x">
</span><span class="m">13</span><span class="o">:</span><span class="m">37</span><span class="o">:</span><span class="m">32.941</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">DELAY</span><span class="x"> </span><span class="n">REQUEST</span><span class="o">:</span><span class="x"> </span><span class="m">3</span><span class="x"> </span><span class="n">seconds</span><span class="x">
</span><span class="m">13</span><span class="o">:</span><span class="m">37</span><span class="o">:</span><span class="m">35.945</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">Step</span><span class="x"> </span><span class="n">ended</span><span class="x"> </span><span class="n">with</span><span class="x"> </span><span class="n">status</span><span class="o">:</span><span class="x"> </span><span class="n">failed</span><span class="x">
</span><span class="m">13</span><span class="o">:</span><span class="m">37</span><span class="o">:</span><span class="m">35.945</span><span class="x"> </span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span><span class="o">:</span><span class="x"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">RuntimeException</span><span class="o">:</span><span class="x">
    </span><span class="n">At</span><span class="x"> </span><span class="n">qitasc</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">tutorial</span><span class="o">/</span><span class="n">customPhoneSteps</span><span class="o">.</span><span class="n">soaptest</span><span class="o">:</span><span class="m">23</span><span class="p">,</span><span class="m">11</span><span class="x"> </span><span class="n">Expression</span><span class="x"> </span><span class="err">'</span><span class="n">seconds</span><span class="o">&gt;</span><span class="n">simulatedActionSeconds</span><span class="err">'</span><span class="x"> </span><span class="n">evaluates</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="no">false</span><span class="o">.</span><span class="x">
    </span><span class="n">At</span><span class="x"> </span><span class="n">qitasc</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">tutorial</span><span class="o">/</span><span class="n">customPhoneSteps</span><span class="o">.</span><span class="n">soaptest</span><span class="x">
	</span><span class="n">at</span><span class="x"> </span><span class="n">at</span><span class="o">.</span><span class="n">inaut</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">CompiledModuleImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">CompiledModuleImpl</span><span class="o">.</span><span class="n">java</span><span class="o">:</span><span class="m">131</span><span class="p">)</span><span class="x">
	</span><span class="n">at</span><span class="x"> </span><span class="n">at</span><span class="o">.</span><span class="n">inaut</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">CommonStepDefinition</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">CommonStepDefinition</span><span class="o">.</span><span class="n">java</span><span class="o">:</span><span class="m">31</span><span class="p">)</span><span class="x">
	</span><span class="n">at</span><span class="x"> </span><span class="err">✽</span><span class="o">.</span><span class="n">Then</span><span class="x"> </span><span class="n">within</span><span class="x"> </span><span class="m">2</span><span class="x"> </span><span class="n">seconds</span><span class="p">,</span><span class="x"> </span><span class="n">expect</span><span class="x"> </span><span class="n">the</span><span class="x"> </span><span class="n">call</span><span class="x"> </span><span class="n">A2B</span><span class="x"> </span><span class="n">to</span><span class="x"> </span><span class="n">connect</span><span class="x">
</span></code></pre></div></div>

<h1 id="using-list-parameters-">Using List Parameters <a name="UsingListParameters"></a></h1>

<p>So far we have shown how to use the following stepdef parameter types <code class="highlighter-rouge">{}</code>, <code class="highlighter-rouge">{ident}</code>, <code class="highlighter-rouge">{phoneTags}</code>, and <code class="highlighter-rouge">{phoneTag}</code>. There is one more stepdef parameter type, <code class="highlighter-rouge">{list}</code>:</p>

<p>This parameter type yields a <strong>list of objects</strong> that is passed as a single parameter (a list) to the stepdef. Before being passed on, the list is evaluated, so it can consist of arbitrary expressions referring to the scenario execution context. Note that the list elements can be separated by commas (<code class="highlighter-rouge">,</code>) or the keyword <code class="highlighter-rouge">and</code> as described above . If you want to use <code class="highlighter-rouge">and</code> as a <strong>boolean operator</strong>, the corresponding element expression must be enclosed in parentheses (<code class="highlighter-rouge">()</code>) to avoid confusing separators and boolean operators.</p>

<p><strong>Stepdef Example</strong></p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stepdef</span><span class="x"> </span><span class="s">"create the list {list}"</span><span class="x"> </span><span class="o">/</span><span class="x"> </span><span class="n">param</span><span class="x"> </span><span class="o">/</span><span class="x">
   </span><span class="k">for</span><span class="x"> </span><span class="n">el</span><span class="x"> </span><span class="n">in</span><span class="x"> </span><span class="n">param</span><span class="x">
       </span><span class="nb">println</span><span class="p">(</span><span class="s">""</span><span class="x"> </span><span class="o">+</span><span class="x"> </span><span class="n">el</span><span class="p">)</span><span class="x">
   </span><span class="n">end</span><span class="x">
</span><span class="n">end</span><span class="x">
</span></code></pre></div></div>

<p><strong>Feature File Example</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>And create the list 1,  (true and false), "abc" and 23 +3, 22
</code></pre></div></div>

<p>This creates a list <code class="highlighter-rouge">[1, false, "abc", 26, 22]</code> and passes it with the name <code class="highlighter-rouge">param</code> to the stepdef. If the parentheses around the boolean expression are removed like below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>And create the list 1,  true and false, "abc" and 23 +3, 22
</code></pre></div></div>

<p>The <code class="highlighter-rouge">and</code> between <code class="highlighter-rouge">true</code> and <code class="highlighter-rouge">false</code> is interpreted as a list element delimiter, so <code class="highlighter-rouge">param</code> is then <code class="highlighter-rouge">[1, true, false, "abc", 26, 22]</code>.</p>

<h2 id="conclusion">Conclusion</h2>
<p>This tutorial has shown you how to replace INTACT’s built-in telephony stepdefs with your own custom implementations, which allowed us to use <strong>virtual phones</strong> in place of real phones. We also showed how to use all five <strong>parameter</strong> types within your stepdefs.</p>

<p>First we showed how to set up a project with a recommended directory structure. Next we demonstrated how to change your INTACT configuration so that INTACT will recognize your custom stepdefs and not use built-in telephony stepdefs. We then showed how to create stepdefs that simulate phone activity on a <strong>virtual phone</strong>.</p>

<p>If you would like to create more test cases using either virtual phones or regular phones, the online INTACT Manual’s <a href="https://docs.qitasc.com/intactbasics/README/">INTACT Basics</a> chapter provides reference material about different test case components including <strong>stepdefs</strong>, <strong>feature files</strong> and INTACT’s languages. The INTACT Manual’s <a href="https://docs.qitasc.com/intactsteps/introduction">Steps and Compound Steps</a> chapter details available built-in steps for use cases including <strong>telephony</strong>, <strong>SMS</strong>, <strong>data</strong> and <strong>interactive phone steps</strong>.</p>

</div>





</br>
</br>
</br>
</br>



      </main>


      <footer>
        <div class="footer-dark">
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-sm-6 col-md-3 item">
                        <div class="footer_h3">Testing Services</div>
                        <ul>
                            <li><a href="/">Project-Based Services</a></li>
                            <li><a href="/">Corporate Testing</a></li>
                            <li><a href="/">Consulting</a></li>
                        </ul>
                    </div>
                    <div class="col-sm-6 col-md-3 item">
                        <div class="footer_h3">Products</div>
                        <ul>
                            <li><a href="/">conQlude</a></li>
                            <li><a href="/">cheQ</a></li>
                            <li><a href="/">intaQt</a></li>
                        </ul>
                    </div>
                    <div class="col-sm-6 col-md-3 item">
                        <div class="footer_h3">About Us</div>
                        <ul>
                            <li><a href="/about/philosophy#contact">Impressum</a></li>
                            <li><a href="/about/philosophy#contact">Contact</a></li>
                            <li><a href="/about/career">Careers</a></li>
                            <li><a href="/about/privacy">Privacy Policy</a></li>
                        </ul>
                    </div>
                    <div class="col-sm-6 col-md-3 item">
                        <div class="footer_h3">Resources</div>
                        <ul>
                            <li><a target="_blank" href="https://docs.qitasc.com">Documentation</a></li>
                            <li><a href="/newsroom">Newsroom</a></li>

                        </ul>
                    </div>
                </div>
                <p class="copyright">QiTASC © 2019</p>
            </div>
        </footer>
    </div>

      </footer>


    <!-- Latest minified jQuery -->
<script
			  src="https://code.jquery.com/jquery-2.2.4.min.js"
			  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
			  crossorigin="anonymous"></script>


<!-- Latest compiled and minified bootstrap JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<script src="/assets/js/navigation.js"></script>
<script src="/assets/js/wordcloud.js"></script>
<script src="/assets/js/hero.js"></script>
<script src="/assets/js/usecases.js"></script>
<script src="/assets/js/jQWCloudv3.1.js"></script>
<script src="/assets/js/index.js"></script>

  </body>
</html>
